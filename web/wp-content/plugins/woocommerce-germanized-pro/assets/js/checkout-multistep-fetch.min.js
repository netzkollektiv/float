window.germanized=window.germanized||{};(function($,germanized){germanized.multistep_checkout_fetch={init:function(){window.originalFetch=fetch;fetch=this.fetch},fetch:function(url,init){if(germanized.multistep_checkout){if(url===germanized.multistep_checkout.getCheckoutUrl()){var e=$.Event("ajaxSend");var settings={url:url,data:init.body};germanized.multistep_checkout.beforeSubmitCheckout(e,settings);init.body=settings.data}}return window.originalFetch(url,init).then(function(response){return new Promise(function(resolve){response.clone().text().then(function(data){if(germanized.multistep_checkout&&(url===germanized.multistep_checkout.getUpdateOrderReviewUrl()||url===germanized.multistep_checkout.getCheckoutUrl())){json=null;try{json=JSON.parse(data)}catch(error){json=null}if(json!==null&&json.hasOwnProperty("fragments")){germanized.multistep_checkout.onRefreshFragments(json)}}resolve(response)})})})}};$(document).ready(function(){germanized.multistep_checkout_fetch.init()})})(jQuery,window.germanized);